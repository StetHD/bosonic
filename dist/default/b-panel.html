<element name="b-panel">
    <template>
        <style>:root {

    /* gradient experiment: remove borders & 3d effect for testing; */
    /*--b-button-primary-bg: linear-gradient(
        to bottom, 
        color(var(--b-button-primary-bg-color) hue(-8deg) saturation(+16%)) 0%, 
        color(var(--b-button-primary-bg-color) hue(-8deg) saturation(+8%)) 4%, 
        var(--b-button-primary-bg-color) 100%
    );*/
}
            :host {
                display: block;
                position: relative;
                border: 1px solid transparent;
                border-color: rgb(214, 214, 214);
                border-radius: 2px 2px 0 0;
                box-shadow: 0 5px 10px rgba(0,0,0,.2);
            }
            .b-panel-content-wrapper {
                display: block;
                margin: 0;
                padding: 0;
                overflow: hidden;
            }
            :host([expandable]:not([open])) .b-panel-content-wrapper {
                display: none;
            }
            .b-panel-content {
                display: block;
                background-color: #fff;
                padding: 0.5em 1em;
                margin: 1px 0 0 0;
            }
            .b-panel-remove {
                position: absolute;
                top: 0.5em;
                right: 1em;
                opacity:.4;
                cursor: pointer;
                border: none;
                background: none;
            }
            .b-panel-resize {
                display: block;
                border: none;
                position: absolute;
                background-color: #ccc;
                width: 8px;
                height: 8px;
                bottom: 0px;
                right: 0px;
            }
            .b-panel-resize:hover {
                cursor: se-resize;
            }
        </style>
        <content select="b-panel-title" tabindex="0"></content>
        <div class="b-panel-content-wrapper">
            <div class="b-panel-content" tabindex="0">
                <content></content>
            </div>
        </div>
    </template>
    <script>
        (function(){
            Bosonic.register({
                get title() {
                    return this.querySelector('b-panel-title');
                },

                get content() {
                    return this.shadowRoot.querySelector('.b-panel-content');
                },

                get wrapper() {
                    return this.shadowRoot.querySelector('.b-panel-content-wrapper');
                },

                get open() {
                    return this.hasAttribute('open');
                },

                createdCallback: function() {
                    if (this.hasCustomAttribute('expandable')) {
                        this.inject(Bosonic.Collapsible, this.wrapper);
                        if (this.title) {
                            this.title.setAttribute('aria-expanded', this.open ? 'true' : 'false');
                        }
                        this.content.setAttribute('aria-hidden', this.open ? 'false' : 'true');
                        if (!this.open) this.content.tabIndex = -1;

                        if (this.title && this.parentNode.nodeName !== 'B-PANELSET') {
                            this.listen(this.title, 'tap', 'toggleExpansion');
                        }
                    }
                    if (this.hasCustomAttribute('removable')) this.inject(Bosonic.Removable);
                    if (this.hasCustomAttribute('resizable')) this.inject(Bosonic.Resizable);
                    if (this.hasCustomAttribute('draggable')) {
                        this.inject(Bosonic.Draggable, { 
                            handle: this.title,
                            containment: this.getCustomAttribute('drag-containment')
                        });
                    }
                },

                toggleExpansion: function() {
                    if (this.open) {
                        this.collapse();
                        this.title.setAttribute('aria-expanded', 'false');
                        this.content.setAttribute('aria-hidden', 'true');
                        this.content.tabIndex = -1;
                    } else {
                        this.expand();
                        this.title.setAttribute('aria-expanded', 'true');
                        this.content.setAttribute('aria-hidden', 'false');
                        this.content.tabIndex = 0;
                    }
                }
            });
        })();
    </script>
</element>

<element name="b-panel-title">
    <style>:root {

    /* gradient experiment: remove borders & 3d effect for testing; */
    /*--b-button-primary-bg: linear-gradient(
        to bottom, 
        color(var(--b-button-primary-bg-color) hue(-8deg) saturation(+16%)) 0%, 
        color(var(--b-button-primary-bg-color) hue(-8deg) saturation(+8%)) 4%, 
        var(--b-button-primary-bg-color) 100%
    );*/
}
        b-panel-title {
            display: block;
            padding: 0.5em 1em;
            margin: 0;
            font-size: 1em;
            font-weight: 500;
            line-height: 1.5;
            background-color: #e0e0e0;
            color: #333;
            box-shadow: 0 1px 0 rgba(0, 0, 0, .3), 0 1px 0 rgba(255, 255, 255, .3) inset;
        }
        b-panel[expandable] > b-panel-title:after {
            float: right;
            content: "\25B4";
        }
        b-panel[expandable][open] > b-panel-title:after {
            float: right;
            content:'\25BE';
        }
    </style>
    <script>
        (function(){
            Bosonic.register({
                hostAttributes: {
                    tabindex: 0
                }
            });
        })();
    </script>
</element>